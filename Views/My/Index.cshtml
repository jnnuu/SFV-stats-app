@using FighterApp.Controllers;
@{
    Layout = "_Layout";
}

@section head
{
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
    <link rel="stylesheet" href="~/css/index.css"/>
}
<div class="LeftSide">
@for (var i =0;i<40;i++)
{
    <button id="@Convert.ToInt32((Fighter_id)i)" onClick="AddHeroToGame(this.id)">@Enum.GetName(typeof(Fighter_id),i)</button>
}
</div>
<a class="ProceedLink" href="SFV/Game/_1/_2"><button class="PostButton" onClick="PostGame()">FIGHT</button></a>



<p>Use this area to provide additional information.</p>
<p>@DateTime.Now</p>
<p>@Convert.ToInt32(Fighter_id.ChunLi) = chun li</p>
<script>
    var i = 0;
    var ids = [];
    function AddHeroToGame(fighter_Id)
    {
        var wasNew = true;   
        if (ids.find(element => element == fighter_Id)) {console.log("already exists! remove?" ); wasNew = false;}
        if (ids.length <2 && wasNew == true) {ids.push(fighter_Id);}

        console.log(ids.length);        
        if (ids.length == 2)
        {
            ReplaceButtonHref(".ProceedLink");
        }
    }
    function ReplaceButtonHref(button_class)
    {
        var href = $(button_class).prop("href");
        var newHref = href
        newHref = href.replace("_1", ids[0]).replace("_2", ids[1]);
        console.log("logging from replacebuttonhref: " + newHref);
        $(button_class).prop("href", newHref);
    }
    function PostGame()
    {
        var url = "http://192.168.100.16:5000/SFV/start/{p1}/{p2}";
        console.log("staring game with ids: " + ids[0] + "and"+ ids[1]);
        $.ajax(url.replace("{p1}", ids[0]).replace("{p2}", ids[1]), {type: 'POST'} ).done(function() {console.log("i did it:" + ids[0] + " " + ids[1]);});
        ids = [];
    }

</script>